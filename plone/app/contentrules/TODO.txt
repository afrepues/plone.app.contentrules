============================
plone.app.contentrules to-do
============================

 Immediate tasks
 ---------------
  
  - Re-enable rule triggering:
  
    1. If the request is annotated with "rules in progress" do nothing
    2. Look for rules for the current event
        2.1. Get directly assigned to context
        2.2. Get bubbled from parent *if not also assigned to current*
    3. If there are any, annotate the request with "rules in progress"
    4. Execute rules in order
        4.1. Don't execute bubbled rules if a local assignment for the same rule exists
        4.2. Abort if any rule.stop is True
  
  - Need events to remove assignments when a rule is removed, keep track of
    references to assignments in rules.
  
  - Triggers on: Workflow transition, Discussion item added
  - Condiitons: Workflow transition was ...
  - Actions: Send email
  
  - Templates have lots of inline styles - this needs to be cleaned up!
  - Buttons for elements in the @@manage-elements view look funny

 Known issues
 ------------
 
  - IObjectAddedEvent executes too early when using Archetypes content objects
    (before the object is initialised from user input, leading to various 
    errors with move-to-folder, copy-to-folder or transition-workflow as
    actions). Therefore, we are using IObjectInitializedEvent from AT, but 
    this is AT specific. Plain-CMF content types are probably a lost cause,
    because we don't have a well-defined event for when they are first 
    initialised. Zope 3 content types or anything with a proper add form
    would work with IObjectAddedEvent, but then the user would have to know
    which one to use.
    
    One option is to listen for IObjectAddedEvent and check for IBaseObject.
    When an AT object is received, delay executing the rule until a subsequent
    IObjectInitializedEvent is received for the same object in the same 
    request. This would still cause problems with plain-CMF content types,
    but would work with items with proper add forms.
    
    This may not be that much of an issue at this point in time, but may be
    going forward.
     
  - Tests for event handling not in place
        
 Design
 ------
  
  - Consider option for making conditions "any" rather than "all"
      - Would imply that conditions and actions be strongly separated at
        the plone.contentrules level.
